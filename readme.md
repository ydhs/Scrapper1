# Scraper1

**Scraper1** — это простой проект для сбора, хранения и визуализации данных о текущей и прогнозной температуре в указанных городах.

---

## Содержание

1. [Функции](#функции)
2. [Структура проекта](#структура-проекта)
3. [Установка](#установка)
4. [Настройка](#настройка)
5. [Запуск](#запуск)
6. [Визуализация](#визуализация)
7. [Структура базы данных](#структура-базы-данных)
8. [Зависимости](#зависимости)

---

## Функции

* **`main.py`** — инициализация базы данных и сбор данных:

  * читает список городов из `settings.json`
  * парсит текущую температуру и прогноз на завтра (Selenium + BeautifulSoup)
  * сохраняет результаты в SQLite (`weather.db`)
* **`parser.py`** — реализация логики парсинга страниц Gismeteo:

  * извлечение текущей и прогнозной температуры
* **`db.py`** — работа с базой данных:

  * создание таблиц при первом запуске
  * добавление и очистка записей
* **`analize.py`** — визуализация данных за любую дату:

  * принимает дату в формате `dd.mm.YYYY`
  * строит графики текущей (сплошная линия) и прогнозной (пунктирная линия) температуры

---

## Структура проекта

```
Scraper1/
├── main.py            # Сбор данных и запись в БД
├── parser.py          # Парсинг HTML-страниц Gismeteo
├── db.py              # Модуль работы с SQLite
├── analize.py         # Визуализация температур за дату
├── settings.json      # Список городов и URL-адреса
├── weather.db         # Файл базы данных (создаётся автоматически)
└── requirements.txt   # Зависимости проекта
```

---

## Установка

1. Склонируйте репозиторий:

   ```bash
   git clone  https://github.com/ydhs/Scrapper1.git
   cd Scraper1
   ```
2. Создайте виртуальное окружение и активируйте его:

   ```bash
   python -m venv .venv
   # Windows PowerShell
   .\.venv\Scripts\Activate.ps1
   # Linux/macOS
   source .venv/bin/activate
   ```
3. Установите зависимости:

   ```bash
   pip install -r requirements.txt
   ```

---

## Настройка

Отредактируйте файл `settings.json`, указав список городов и соответствующие URL для текущей и прогнозной температур:

```json
{
  "cities": [
    {
      "name": "Москва",
      "current_url": "https://...",
      "forecast_url": "https://..."
    },
    {
      "name": "Санкт-Петербург",
      "current_url": "https://...",
      "forecast_url": "https://..."
    }
  ]
}
```

---

## Запуск

1. **Сбор данных**:

   ```bash
   python main.py
   ```

   После выполнения появится файл `weather.db` с заполненными таблицами.

2. **Визуализация**:

   ```bash
   python analize.py DD.MM.YYYY
   ```

   Где `DD.MM.YYYY` — интересующая вас дата. Скрипт отрисует график для текущей и прогнозной температур.

---

## Структура базы данных

Используется SQLite-файл `weather.db` с тремя таблицами:

* `cities`:

  * `id` (INTEGER, PK) — идентификатор города
  * `name` (TEXT) — название города
  * `url` (TEXT) — базовый URL для парсинга
* `current_temperature`:

  * `id` (INTEGER, PK) — идентификатор записи
  * `city_id` (INTEGER) — внешний ключ на `cities.id`
  * `temperature` (REAL) — текущая температура (°C)
  * `timestamp` (TEXT) — время сбора
* `forecast_temperature`:

  * `id` (INTEGER, PK) — идентификатор записи
  * `city_id` (INTEGER) — внешний ключ на `cities.id`
  * `timestamp` (TEXT) — время прогноза
  * `temperature` (REAL) — прогнозная температура (°C)

Каждая запись связывает температуру с городом из таблицы `cities`.

---

## Зависимости

* Python ≥3.x
* `selenium`
* `beautifulsoup4`
* `pandas`
* `matplotlib`
